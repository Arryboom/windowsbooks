unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, kd5driver, StdCtrls;

type
  TForm1 = class(TForm)
    Button1: TButton;
    Memo1: TMemo;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Button5: TButton;
    Button6: TButton;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
  private
   procedure AddToLog(S : string);
  public
   KD5Link : TKD5Driver;
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
 KD5Link := TKD5Driver.Create;
 KD5Link.DriverPath := ExtractFilePath(Application.ExeName);
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
 if KD5Link.InstallDriver then
  AddToLog('InstallDriver: успешно')
 else
  AddToLog('InstallDriver: ошибка');
end;

procedure TForm1.AddToLog(S: string);
begin
 Memo1.Lines.Add(S);
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
 if KD5Link.LoadDriver then
  AddToLog('LoadDriver: успешно')
 else
  AddToLog('LoadDriver: ошибка');
end;

procedure TForm1.Button3Click(Sender: TObject);
begin
 if KD5Link.UnLoadDriver then
  AddToLog('UnLoadDriver: успешно')
 else
  AddToLog('UnLoadDriver: ошибка');
end;

procedure TForm1.Button4Click(Sender: TObject);
begin
 if KD5Link.UnInstallDriver then
  AddToLog('UnInstallDriver: успешно')
 else
  AddToLog('UnInstallDriver: ошибка');
end;

procedure TForm1.Button5Click(Sender: TObject);
begin
 if KD5Link.CallDriver_SETHOOK then
  AddToLog('CallDriver_SETHOOK: успешно')
 else
  AddToLog('CallDriver_SETHOOK: ошибка');
end;

procedure TForm1.Button6Click(Sender: TObject);
begin
 if KD5Link.CallDriver_DELHOOK then
  AddToLog('CallDriver_DELHOOK: успешно')
 else
  AddToLog('CallDriver_DELHOOK: ошибка');
end;

end.
